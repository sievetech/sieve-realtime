<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Sieve Realtime Client Example</title>

		<script src="http://localhost:1337/socket.io/socket.io.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

		<script>
		  var socket = io.connect('http://localhost:1337'); 		  

		  //antes de gerar essa tela, criamos (via Python) uma entrada no Redis com a ID, a key e a lista de produtos do usuário
		  socket.on('user infos', function (fn) {
		    
		    fn({
		    	"id": Math.floor(Math.random()*11), 
		    	"key": 12345,
		    	"rooms": ["category/8383", "category/1234"]
		    });

		  });
		  

		  socket.on('something changed', function (message) {
		  	console.log(message);
		  	$('#stream').prepend("<p><img src='" + message.tx_image_url + "'/>" + message.nm_product + "</p>")      
		  });

		  socket.on('room joined', function (message) {
		  	console.log(message);
		  	$('#stream').prepend("<p>" + message + "</p>")      
		  });


		</script>

	</head>

	<body>		
		<p><b>Exemplo com os últimos produtos atualizados:</b></p>
		<div id="stream">
		</div>
	</body>

</html>